import{_ as N,i as U,r as _,c as u,a,l as v,b as t,k as d,I as D,e as p,J as E,d as f,G as y,H as F,o as m,f as w,t as V,K as S,C as s}from"./index-BNfsHRSS.js";import{a as k}from"./index-DvJ3witA.js";const G={class:"forget-container"},H={class:"forget-box"},J={class:"forget-form"},K={class:"form-item"},L={key:0,class:"form-item"},M={class:"code-wrapper"},R={key:1,class:"form-item"},T={key:2,class:"form-item"},$={class:"form-item"},j={class:"back-login"},q={__name:"index",setup(A){const g=F(),e=U({email:"",code:"",newPassword:"",confirmPassword:""}),h=_(""),i=_(0),l=_(!1),b=async()=>{if(!e.email){s.error("请输入邮箱地址");return}try{const r=await k.get("http://localhost:8080/generateCode",{params:{to:e.email}});r.data.code==="200"&&(h.value=r.data.data,C(),s.success("验证码已发送"))}catch{s.error("验证码发送失败")}},C=()=>{i.value=60;const r=setInterval(()=>{i.value--,i.value<=0&&clearInterval(r)},1e3)},P=async()=>{if(!l.value){if(!e.code){s.error("请输入验证码");return}if(e.code!==h.value){s.error("验证码错误");return}l.value=!0;return}if(l.value){if(!e.email){s.error("请输入邮箱");return}if(!e.newPassword){s.error("请输入新密码");return}if(e.newPassword!==e.confirmPassword){s.error("两次输入密码不一致");return}try{(await k.post("http://localhost:8080/api/user/changePassword",{account:e.email,password:e.newPassword})).data.code==="200"?(s.success("密码修改成功"),g.push("/stellerprofile/login")):s.error("密码修改失败")}catch{s.error("密码修改失败")}}},z=()=>{g.push("/stellerprofile/login")};return(r,o)=>{const c=p("el-input"),x=p("el-button"),B=p("el-icon"),I=p("el-link");return m(),u("div",G,[a("div",H,[o[5]||(o[5]=a("div",{class:"forget-header"},[a("h1",{class:"auth-title"},"找回密码"),a("p",{class:"auth-subtitle"},"重置您的账户密码")],-1)),a("div",J,[a("div",K,[t(c,{modelValue:e.email,"onUpdate:modelValue":o[0]||(o[0]=n=>e.email=n),placeholder:"请输入注册邮箱","prefix-icon":d(D),size:"large",clearable:""},null,8,["modelValue","prefix-icon"])]),l.value?v("",!0):(m(),u("div",L,[a("div",M,[t(c,{modelValue:e.code,"onUpdate:modelValue":o[1]||(o[1]=n=>e.code=n),placeholder:"请输入验证码","prefix-icon":d(E),size:"large",class:"code-input"},null,8,["modelValue","prefix-icon"]),t(x,{class:"code-btn",disabled:i.value>0,onClick:b},{default:f(()=>[w(V(i.value>0?`重新发送(${i.value})`:"获取验证码"),1)]),_:1},8,["disabled"])])])),l.value?(m(),u("div",R,[t(c,{modelValue:e.newPassword,"onUpdate:modelValue":o[2]||(o[2]=n=>e.newPassword=n),placeholder:"请输入新密码","prefix-icon":d(y),type:"password",size:"large","show-password":""},null,8,["modelValue","prefix-icon"])])):v("",!0),l.value?(m(),u("div",T,[t(c,{modelValue:e.confirmPassword,"onUpdate:modelValue":o[3]||(o[3]=n=>e.confirmPassword=n),placeholder:"请再次输入新密码","prefix-icon":d(y),type:"password",size:"large","show-password":""},null,8,["modelValue","prefix-icon"])])):v("",!0),a("div",$,[t(x,{type:"primary",class:"submit-btn",onClick:P},{default:f(()=>[w(V(l.value?"重置密码":"提交"),1)]),_:1})])]),a("div",j,[t(I,{type:"primary",onClick:z},{default:f(()=>[t(B,null,{default:f(()=>[t(d(S))]),_:1}),o[4]||(o[4]=w(" 返回登录 "))]),_:1})])])])}}},W=N(q,[["__scopeId","data-v-36087799"]]);export{W as default};
